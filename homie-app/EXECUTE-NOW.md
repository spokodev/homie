# üö® –í–ò–ö–û–ù–ê–ô–¢–ï –ú–Ü–ì–†–ê–¶–Ü–Æ –ó–ê–†–ê–ó

## –ü—Ä–æ–±–ª–µ–º–∞ –∑ Service Key
–ö–ª—é—á —è–∫–∏–π –≤–∏ –Ω–∞–¥–∞–ª–∏ (`sb_secret_WyIm-vVVodZ0WV_Y7ofQAw_7Au0tmvA`) - —Ü–µ –Ω–µ –ø–æ–≤–Ω–∏–π JWT —Ç–æ–∫–µ–Ω.

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –º—ñ–≥—Ä–∞—Ü—ñ—ó –ø–æ—Ç—Ä—ñ–±–µ–Ω –ø–æ–≤–Ω–∏–π `service_role` –∫–ª—é—á, —è–∫–∏–π –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS...–ø–æ–≤–Ω–∏–π_—Ç–æ–∫–µ–Ω_—Ç—É—Ç
```

## ‚úÖ –†–Ü–®–ï–ù–ù–Ø: –†—É—á–Ω–∞ –º—ñ–≥—Ä–∞—Ü—ñ—è —á–µ—Ä–µ–∑ SQL Editor

–Ø —Å—Ç–≤–æ—Ä–∏–≤ –ø–æ–≤–Ω–∏–π —Ñ–∞–π–ª –º—ñ–≥—Ä–∞—Ü—ñ—ó —è–∫–∏–π –≤–∏—Ä—ñ—à—É—î –≤—Å—ñ –ø—Ä–æ–±–ª–µ–º–∏:

### üìÅ –§–∞–π–ª: `FINAL-MIGRATION.sql`

–¶–µ–π —Ñ–∞–π–ª:
1. ‚úÖ –°–ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—é—î —Ç–∞–±–ª–∏—Ü—é `recurring_tasks` (—è–∫–æ—ó –Ω–µ –≤–∏—Å—Ç–∞—á–∞–ª–æ)
2. ‚úÖ –°—Ç–≤–æ—Ä—é—î –≤—Å—ñ –Ω–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ (categories, subtasks, photos)
3. ‚úÖ –î–æ–¥–∞—î –≤—Å—ñ –∫–æ–ª–æ–Ω–∫–∏ –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é —á–∏ –≤–æ–Ω–∏ –≤–∂–µ —ñ—Å–Ω—É—é—Ç—å
4. ‚úÖ –°—Ç–≤–æ—Ä—é—î –≤—Å—ñ RLS –ø–æ–ª—ñ—Ç–∏–∫–∏
5. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–¥–∞—î –¥–µ—Ñ–æ–ª—Ç–Ω—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –¥–ª—è –≤—Å—ñ—Ö households

## üî• –ö–†–û–ö–ò –î–õ–Ø –í–ò–ö–û–ù–ê–ù–ù–Ø:

### 1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Supabase Dashboard
üîó https://supabase.com/dashboard/project/ojmmvaoztddrgvthcjit/sql/new

### 2. –°–∫–æ–ø—ñ—é–π—Ç–µ –≤–µ—Å—å –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É
```bash
cat FINAL-MIGRATION.sql
```
–ê–±–æ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª –≤ VS Code —ñ —Å–∫–æ–ø—ñ—é–π—Ç–µ –≤—Å–µ (Cmd+A, Cmd+C)

### 3. –í—Å—Ç–∞–≤—Ç–µ –≤ SQL Editor
- –í–∏–¥–∞–ª—ñ—Ç—å placeholder —Ç–µ–∫—Å—Ç
- –í—Å—Ç–∞–≤—Ç–µ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–∏–π SQL (Cmd+V)

### 4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Run" (–∞–±–æ Cmd+Enter)
–ú—ñ–≥—Ä–∞—Ü—ñ—è –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ

### 5. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
–í –∫—ñ–Ω—Ü—ñ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—é –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏:
- ‚úÖ 4 tables created
- ‚úÖ 4 columns in tasks table
- ‚úÖ 6 rotation columns in recurring_tasks
- ‚úÖ 12+ RLS policies
- ‚úÖ 12 categories per household

## ‚è∞ –ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: ~10 —Å–µ–∫—É–Ω–¥

## üéâ –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –º—ñ–≥—Ä–∞—Ü—ñ—ó:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å –¥–æ–¥–∞—Ç–æ–∫:**
```bash
# –ó—É–ø–∏–Ω—ñ—Ç—å Expo (Ctrl+C)
npx expo start --tunnel
```

2. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª:**
- –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è
- –î–æ–¥–∞–π—Ç–µ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó

## üÜò –Ø–∫—â–æ —â–æ—Å—å –Ω–µ –ø—Ä–∞—Ü—é—î:

1. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ–º–∏–ª–∫–∏ –≤ SQL Editor** - —á–µ—Ä–≤–æ–Ω–∏–π —Ç–µ–∫—Å—Ç –ø–æ–∫–∞–∂–µ —â–æ –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫

2. **–Ø–∫—â–æ –±–∞—á–∏—Ç–µ "relation already exists"** - —Ü–µ –û–ö, —Ç–∞–±–ª–∏—Ü—è –≤–∂–µ —Å—Ç–≤–æ—Ä–µ–Ω–∞

3. **–Ø–∫—â–æ —Ç—Ä–µ–±–∞ –ø–æ—á–∞—Ç–∏ –∑–∞–Ω–æ–≤–æ:**
```sql
-- –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å–µ (–û–ë–ï–†–ï–ñ–ù–û!)
DROP TABLE IF EXISTS task_photos CASCADE;
DROP TABLE IF EXISTS subtasks CASCADE;
DROP TABLE IF EXISTS task_categories CASCADE;
DROP TABLE IF EXISTS recurring_tasks CASCADE;
```

## üìä –©–æ –¥–æ–¥–∞—î—Ç—å—Å—è –≤ –±–∞–∑—É:

### –ù–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ:
- `recurring_tasks` - –¥–ª—è –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å
- `task_categories` - –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –∑–∞–≤–¥–∞–Ω—å (–ø–æ 12 –Ω–∞ household)
- `subtasks` - –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –∑ –±–∞–ª–∞–º–∏
- `task_photos` - —Ñ–æ—Ç–æ –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è

### –ù–æ–≤—ñ –∫–æ–ª–æ–Ω–∫–∏ –≤ `tasks`:
- `category_id` - –∑–≤'—è–∑–æ–∫ –∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—î—é
- `has_subtasks` - —á–∏ –º–∞—î –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è
- `completed_subtask_ids` - —è–∫—ñ –ø—ñ–¥–∑–∞–≤–¥–∞–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω—ñ
- `recurring_task_id` - –∑–≤'—è–∑–æ–∫ –∑ –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º

### –ù–æ–≤—ñ –∫–æ–ª–æ–Ω–∫–∏ –≤ `recurring_tasks`:
- –ü–æ–ª—è –¥–ª—è —Ä–æ—Ç–∞—Ü—ñ—ó (—ñ–Ω—Ç–µ—Ä–≤–∞–ª, —Å–ø–∏—Å–æ–∫ —É—á–∞—Å–Ω–∏–∫—ñ–≤, –ø–æ—Ç–æ—á–Ω–∏–π —ñ–Ω–¥–µ–∫—Å)
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤: minute, hour, day, week, month, year

---

**–í–ò–ö–û–ù–ê–ô–¢–ï –ó–ê–†–ê–ó:** –í—ñ–¥–∫—Ä–∏–π—Ç–µ SQL Editor —ñ –∑–∞–ø—É—Å—Ç—ñ—Ç—å `FINAL-MIGRATION.sql`